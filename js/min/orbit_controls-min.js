THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*l.autoRotateSpeed}function o(){return Math.pow(.95,l.zoomSpeed)}function i(t){if(l.enabled!==!1){if(t.preventDefault(),t.button===l.mouseButtons.ORBIT){if(l.noRotate===!0)return;D=x.ROTATE,E.set(t.clientX,t.clientY)}else if(t.button===l.mouseButtons.ZOOM){if(l.noZoom===!0)return;D=x.DOLLY,g.set(t.clientX,t.clientY)}else if(t.button===l.mouseButtons.PAN){if(l.noPan===!0)return;D=x.PAN,b.set(t.clientX,t.clientY)}D!==x.NONE&&(document.addEventListener("mousemove",a,!1),document.addEventListener("mouseup",s,!1),l.dispatchEvent(Y))}}function a(t){if(l.enabled!==!1){t.preventDefault();var e=l.domElement===document?l.domElement.body:l.domElement;if(D===x.ROTATE){if(l.noRotate===!0)return;m.set(t.clientX,t.clientY),f.subVectors(m,E),l.rotateLeft(2*Math.PI*f.x/e.clientWidth*l.rotateSpeed),l.rotateUp(2*Math.PI*f.y/e.clientHeight*l.rotateSpeed),E.copy(m)}else if(D===x.DOLLY){if(l.noZoom===!0)return;R.set(t.clientX,t.clientY),H.subVectors(R,g),H.y>0?l.dollyIn():l.dollyOut(),g.copy(R)}else if(D===x.PAN){if(l.noPan===!0)return;T.set(t.clientX,t.clientY),O.subVectors(T,b),l.pan(O.x,O.y),b.copy(T)}D!==x.NONE&&l.update()}}function s(){l.enabled!==!1&&(document.removeEventListener("mousemove",a,!1),document.removeEventListener("mouseup",s,!1),l.dispatchEvent(I),D=x.NONE)}function r(t){if(l.enabled!==!1&&l.noZoom!==!0&&D===x.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?l.dollyOut():l.dollyIn(),l.update(),l.dispatchEvent(Y),l.dispatchEvent(I)}}function c(t){if(l.enabled!==!1&&l.noKeys!==!0&&l.noPan!==!0)switch(t.keyCode){case l.keys.UP:l.pan(0,l.keyPanSpeed),l.update();break;case l.keys.BOTTOM:l.pan(0,-l.keyPanSpeed),l.update();break;case l.keys.LEFT:l.pan(l.keyPanSpeed,0),l.update()}}function h(t){if(l.enabled!==!1){switch(t.touches.length){case 1:if(l.noRotate===!0)return;D=x.TOUCH_ROTATE,E.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(l.noZoom===!0)return;D=x.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(e*e+n*n);g.set(0,o);break;case 3:if(l.noPan===!0)return;D=x.TOUCH_PAN,b.set(t.touches[0].pageX,t.touches[0].pageY);break;default:D=x.NONE}D!==x.NONE&&l.dispatchEvent(Y)}}function u(t){if(l.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=l.domElement===document?l.domElement.body:l.domElement;switch(t.touches.length){case 1:if(l.noRotate===!0)return;if(D!==x.TOUCH_ROTATE)return;m.set(t.touches[0].pageX,t.touches[0].pageY),f.subVectors(m,E),l.rotateLeft(2*Math.PI*f.x/e.clientWidth*l.rotateSpeed),l.rotateUp(2*Math.PI*f.y/e.clientHeight*l.rotateSpeed),E.copy(m),l.update();break;case 2:if(l.noZoom===!0)return;if(D!==x.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(n*n+o*o);R.set(0,i),H.subVectors(R,g),H.y>0?l.dollyOut():l.dollyIn(),g.copy(R),l.update();break;case 3:if(l.noPan===!0)return;if(D!==x.TOUCH_PAN)return;T.set(t.touches[0].pageX,t.touches[0].pageY),O.subVectors(T,b),l.pan(O.x,O.y),b.copy(T),l.update();break;default:D=x.NONE}}}function d(){l.enabled!==!1&&(l.dispatchEvent(I),D=x.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var l=this,p=1e-6,E=new THREE.Vector2,m=new THREE.Vector2,f=new THREE.Vector2,b=new THREE.Vector2,T=new THREE.Vector2,O=new THREE.Vector2,v=new THREE.Vector3,y=new THREE.Vector3,g=new THREE.Vector2,R=new THREE.Vector2,H=new THREE.Vector2,M,L,P=0,N=0,A=1,w=new THREE.Vector3,V=new THREE.Vector3,j=new THREE.Quaternion,x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},D=x.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var U=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),k=U.clone().inverse(),S={type:"change"},Y={type:"start"},I={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=n()),N-=t},this.rotateUp=function(t){void 0===t&&(t=n()),P-=t},this.panLeft=function(t){var e=this.object.matrix.elements;v.set(e[0],e[1],e[2]),v.multiplyScalar(-t),w.add(v)},this.panUp=function(t){var e=this.object.matrix.elements;v.set(e[4],e[5],e[6]),v.multiplyScalar(t),w.add(v)},this.pan=function(t,e){var n=l.domElement===document?l.domElement.body:l.domElement;if(void 0!==l.object.fov){var o=l.object.position,i=o.clone().sub(l.target),a=i.length();a*=Math.tan(l.object.fov/2*Math.PI/180),l.panLeft(2*t*a/n.clientHeight),l.panUp(2*e*a/n.clientHeight)}else void 0!==l.object.top?(l.panLeft(t*(l.object.right-l.object.left)/n.clientWidth),l.panUp(e*(l.object.top-l.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=o()),A/=t},this.dollyOut=function(t){void 0===t&&(t=o()),A*=t},this.update=function(){var t=this.object.position;y.copy(t).sub(this.target),y.applyQuaternion(U),M=Math.atan2(y.x,y.z),L=Math.atan2(Math.sqrt(y.x*y.x+y.z*y.z),y.y),this.autoRotate&&D===x.NONE&&this.rotateLeft(n()),M+=N,L+=P,M=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,M)),L=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,L)),L=Math.max(p,Math.min(Math.PI-p,L));var e=y.length()*A;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(w),y.x=e*Math.sin(L)*Math.sin(M),y.y=e*Math.cos(L),y.z=e*Math.sin(L)*Math.cos(M),y.applyQuaternion(k),t.copy(this.target).add(y),this.object.lookAt(this.target),N=0,P=0,A=1,w.set(0,0,0),(V.distanceToSquared(this.object.position)>p||8*(1-j.dot(this.object.quaternion))>p)&&(this.dispatchEvent(S),V.copy(this.object.position),j.copy(this.object.quaternion))},this.reset=function(){D=x.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.getPolarAngle=function(){return L},this.getAzimuthalAngle=function(){return M},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",r,!1),this.domElement.addEventListener("DOMMouseScroll",r,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",u,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;