jQuery(document).ready(function($){function t(t){var i=new e(t,10);a=[i]}function e(t,e){return t.stripes(e),this.terrain_geometry=new THREE.PlaneGeometry(100,1.5*r.data.length,63,r.data.length),this.terrain_material=new THREE.MeshBasicMaterial({color:2236962}),this.terrain_wire_material=new THREE.MeshBasicMaterial({color:6710886,wireframe:!0}),this.total=0,this.stripe_count=e,this.color_count=0,this.set_vertices=!0,this.colors=[],this.terrain_wire=null,this.generate=function(){if(this.stripes=t.get_next_stripe(),!this.stripes)return this.terrain=new THREE.Mesh(this.terrain_geometry,this.terrain_material),this.terrain_wire=new THREE.Mesh(this.terrain_geometry.clone(),this.terrain_wire_material),this.terrain.rotation.x=-Math.PI/2,this.terrain.rotation.z=-Math.PI/2,this.terrain.scale.set(.8,.8,.8),this.terrain_wire.scale.set(.8,.8,.8),this.terrain_wire.rotation.x=-Math.PI/2,this.terrain_wire.rotation.z=-Math.PI/2,this.terrain_wire.position.y=.01,this.terrain.position.x=90,this.terrain_wire.position.x=90,l.add(this.terrain,this.terrain_wire),this;for(var e=0;e<this.stripes.length;e++){for(var i=32;i>0;i--)this.total++,this.terrain_geometry.vertices[this.total].z=.05*this.stripes[e][i];for(var r=0;32>r;r++)this.total++,this.terrain_geometry.vertices[this.total].z=.05*this.stripes[e][r]}this.generate()},this.update=function(){},this.generate(),this}function i(){}var r={data:{},size:10,store_data:function(t){this.data=t},calculate_stripes:function(t){if(!t)return!1;var e,i,r,s=t,a=[];for(e=0,i=this.data.length;i>e;e+=s)r=this.data.slice(e,e+s),a.push(r);return a},stripes_count:0,stripes_data:[],stripes:function(t){if(i)return!1;if(t)if(t!=e)e=t;else var e=t;else var e=this.size;var i=this.calculate_stripes(e);return this.stripes_count=i.length,this.stripes_data=i,!1},loop:!1,get_next_stripe:function(){var t=0;return 0!=this.stripes_count?(t=this.stripes_data.length-this.stripes_count,this.stripes_count--,this.stripes_data[t]?this.stripes_data[t]:!1):this.loop?(this.stripes_count=this.stripes_data.length,this.stripes_data[0]?this.stripes_data[0]:!1):!1},get_prev_stripe:function(){if(0!=this.stripes_count&&this.stripes_count!==this.stripes_data.length){this.stripes_count++;var t=this.stripes_data.length-this.stripes_count;return this.stripes_data[t]}}},s={ready:!1,play:!1,range:1,duration:2500,delay:200,easing:"Elastic.EaseInOut",camera:{x:0,y:20,z:50,target:{x:0,y:10,z:-40},orbit:{rotateSpeed:.1,keyPanSpeed:.001,maxPolarAngle:Math.PI/2,center:new THREE.Vector3(0,0,0)},fly:{movementSpeed:1,rollSpeed:.01,autoForward:!1,dragToLook:!0}}},a=[],n={};$.ajax({dataType:"json",url:"js/audioData_4.json",success:function(e){s.ready=!0,r.store_data(e),t(r)}});var o=16777215,h=window.innerHeight-window.innerHeight/4,c=window.innerWidth,l=new THREE.Scene;l.fog=new THREE.FogExp2(o,.015);var p=new THREE.PerspectiveCamera(55,c/h,.1,1e3);p.lookAt(new THREE.Vector3(0,0,0)),p.position.set(80,10,20);var d=new THREE.WebGLRenderer({alpha:!0});d.setSize(c,h),d.shadowMapEnabled=!0,d.shadowMapType=THREE.PCFSoftShadowMap,d.setClearColor(o,1),d.domElement.className="header_canvas",$("header").append(d.domElement),window.onresize=function(){h=window.innerHeight-window.innerHeight/4,c=window.innerWidth,p.aspect=c/h,p.updateProjectionMatrix(),d.setSize(c,h)},controls=new THREE.OrbitControls(p),controls.damping=.2,controls.maxPolarAngle=Math.PI/2,controls.minDistance=100,controls.maxDistance=400,controls.enabled=!1,$("canvas").on("mouseenter",function(t){controls.enabled=!0}),$("canvas").on("mouseleave",function(t){controls.enabled=!1});var u=new THREE.SpotLight(16777215);u.position.set(0,100,100),u.intensity=1,u.castShadow=!0,l.add(u);var _={width:window.innerWidth,height:window.innerHeight,position:{x:0,y:.25,z:0}},w={color:16777215},E=new THREE.PlaneBufferGeometry(_.width,_.height,32),g=new THREE.MeshBasicMaterial(w),f=new THREE.Mesh(E,g);f.rotation.x=-Math.PI/2,f.position.x=_.position.x,f.position.y=_.position.y,f.position.z=_.position.z,f.receiveShadow=!0,l.add(f);var m=function(){requestAnimationFrame(m),i(),d.render(l,p)};m();var v=$(".overlay .rotate"),y=v.text();v.empty();var H=y.split("");H.forEach(function(t){v.append("<span>"+t+"</span>")})});